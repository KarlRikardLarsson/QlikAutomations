{"blocks":[{"id":"7083AE87-0D83-4A90-AD0D-5F66C33AFBB7","type":"StartBlock","disabled":false,"name":"Start","displayName":"Start","comment":"The webhook run-mode will trigger automation on every failed app reload. You can filter based on apps and spaces. (Note: Filters App Ids and Space Ids work like OR statements.)","childId":"069AFE5C-E7B5-457A-9120-A6FF23F67D3E","inputs":[{"id":"run_mode","value":"scheduled","type":"select","structure":{}},{"id":"schedule_start","value":"2025-05-01 16:58:18","type":"date","structure":{}},{"id":"schedule_stoptime","value":null,"type":"date","structure":{}},{"id":"schedule_interval","value":"3600","type":"select","structure":{}},{"id":"schedule_timezone","value":"Europe/Warsaw","type":"select","structure":{}}],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":314,"y":-354},{"id":"069AFE5C-E7B5-457A-9120-A6FF23F67D3E","type":"VariableBlock","disabled":false,"name":"SpaceIDtoCheck","displayName":"Variable - SpaceIDtoCheck","comment":"Configuration SpaceID to check. Vill check for reload status of apps in space.","childId":"E645A78B-EE8E-4413-9CB8-E8D92DB49675","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":747,"y":-100,"variableGuid":"B0F0CA43-A941-45A3-B81C-BF5FB35A8433","operations":[{"id":"add_item","key":"3F00D4F8-234C-45FF-8314-D997BAE20FA3","name":"Add item to { variable }","value":"6306206be947bcdcb411ce61"}]},{"id":"743BE233-3DCB-476B-8C49-5BC84BC8FC8B","type":"VariableBlock","disabled":false,"name":"Customer","displayName":"Variable - Customer","comment":"Customers - name. Used in email","childId":"7F319E41-B5F2-4A58-A9AC-48568BF95A4F","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":372,"y":-199,"variableGuid":"158901F7-87FB-4DA5-ACC8-B2DAA5B7E270","operations":[{"id":"set_value","key":"44937DF8-6310-4CFC-A011-5D5A3D1FA98E","name":"Set value of { variable }","value":"Qlikard AB"}]},{"id":"E05C8624-DB72-478E-92BD-9047EF785A3A","type":"ForEachBlock","disabled":false,"name":"loop2","displayName":"Loop 2","comment":"","childId":"FF2C3805-7596-48B3-9C4F-AB6BCEF9C72A","inputs":[{"id":"input","value":"{ $.SpaceIDtoCheck }","type":"string","structure":[]}],"settings":[{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":556,"y":593,"loopBlockId":"4E0C6A1A-108E-4EAD-85D5-B9B2CB2C4392"},{"id":"C4077C9E-DA75-4EF2-A89F-2142575B2770","type":"VariableBlock","disabled":false,"name":"reloadMessage","displayName":"Variable - reloadMessage","comment":"","childId":"FB8A79DC-40B8-4A38-9AAB-5DC6CD009D7E","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":434,"y":3846,"variableGuid":"C28BBFB6-65C5-4C19-A103-223ED684887D","operations":[{"id":"set_value","key":"FCE6032E-1A3A-4519-822C-AEB699AD2D4A","name":"Set value of { variable }","value":"Applications {$.itr}:  ( {$.itrReloadSuccessful} successful,{ $.itrReloading } \nreloading ,    {$.itrReloadFailed} failed)"}]},{"id":"FB8A79DC-40B8-4A38-9AAB-5DC6CD009D7E","type":"UpdateJobBlock","disabled":false,"name":"updateRunTitle5","displayName":"Update Run Title 5","comment":"","childId":"D4F4F950-866E-4E96-AB4D-474AE6712D9B","inputs":[{"id":"title","value":"{$.reloadMessage}","type":"string","structure":[]}],"settings":[{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":434,"y":3966},{"id":"D4F4F950-866E-4E96-AB4D-474AE6712D9B","type":"EndpointBlock","disabled":false,"name":"listAutomations","displayName":"Qlik Cloud Services - List Automations","comment":"Finding status of previous run","childId":"2A018AEF-E055-42FD-97BB-88A3CA6DFD6E","inputs":[{"id":"4da7b650-cc5c-11ec-b5fd-57c6cdbb55e5","value":null,"type":"string","structure":[]},{"id":"a3c3eb00-cc65-11ec-b047-91d50a3080e1","value":"name co \"{automationname}\"","type":"string","structure":[]}],"settings":[{"id":"maxitemcount","value":"","type":"string","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"cache","value":"0","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":true}],"x":936,"y":3578,"loopBlockId":null,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","endpoint_guid":"4d780290-cc5c-11ec-aefa-6169dde43f42","endpoint_role":"list"},{"id":"2A018AEF-E055-42FD-97BB-88A3CA6DFD6E","type":"IfElseBlock","disabled":false,"name":"condition12","displayName":"Condition 12","comment":"Recovered email if previous automation failed","childId":"1F6E00CD-CD79-4BE7-9318-CF80651B462A","inputs":[{"id":"conditions","value":{"mode":"some","conditions":[{"input1":"{$.listAutomations[0].lastRunStatus}","input2":"failed","operator":"="}]},"type":"custom","structure":[]}],"settings":[],"collapsed":[{"name":"both","isCollapsed":false},{"name":"yes","isCollapsed":false},{"name":"no","isCollapsed":false}],"x":808,"y":4204,"childTrueId":"736FBA85-C1F6-4489-8A41-0D82420452B4","childFalseId":null},{"id":"87A5E759-98D9-4E78-9141-7D39ADF03B05","type":"EndpointBlock","disabled":false,"name":"listApps3","displayName":"Qlik Cloud Services - List Apps 3","comment":"","childId":null,"inputs":[{"id":"8cd8db50-107b-11ec-8082-edc45dd151ef","value":"8cde3d40-107b-11ec-98de-39d96a8971e1","type":"select","displayValue":"+name","structure":[]},{"id":"8ce4fad0-107b-11ec-a6ac-2bd407ad134b","value":"{ $.loop2.item }","type":"string","structure":[]}],"settings":[{"id":"maxitemcount","value":"","type":"string","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"cache","value":"0","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":698,"y":969,"loopBlockId":"0A8FA058-7CD9-4AD7-86E2-DBFD622F8538","datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","endpoint_guid":"8cc63340-107b-11ec-ab5d-f9b221ed2dc5","endpoint_role":"list"},{"id":"649F1429-330F-4CCA-92D2-4496B5D40F30","type":"EndpointBlock","disabled":false,"name":"rawAPIRequest3","displayName":"Qlik Cloud Services - Raw API Request 3","comment":"Retrieve the app information by fetching the item ","childId":"5B6ABE37-0069-4125-804E-CA83B9E2C17C","inputs":[{"id":"4add8960-2078-11ec-be2c-7fc55d771fe6","value":"items","type":"string","structure":[]},{"id":"3b992a40-2072-11ec-9f0e-ed01586a7e1b","value":"3ba1eed0-2072-11ec-aa67-f118ee53373a","type":"select","displayValue":"GET","structure":[]},{"id":"3b8b9090-2072-11ec-8c77-5195fbb0ca65","value":[],"type":"object","mode":"keyValue","structure":[]},{"id":"993585d0-2839-11ec-b431-df4deed6c1ae","value":[{"key":"resourceId","value":"{ $.listApps3.item.id }"},{"key":"resourceType","value":"app"}],"type":"object","mode":"keyValue","structure":[]}],"settings":[{"id":"blendr_on_error","value":"warning","type":"select","displayValue":"Warning - Continue Automation and report errors","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":554,"y":686,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","endpoint_guid":"3b75dd80-2072-11ec-9043-3b2aff6123af","endpoint_role":"create"},{"id":"4E0C6A1A-108E-4EAD-85D5-B9B2CB2C4392","type":"EndpointBlock","disabled":false,"name":"getSpace2","displayName":"Qlik Cloud Services - Get Space 2","comment":"","childId":"57479A67-26C8-4998-99AB-863C701C86C5","inputs":[{"id":"92f7bcd0-6d2d-11eb-9088-69419de8f253","value":"{ $.loop2.item }","type":"string","structure":[]}],"settings":[{"id":"blendr_on_error","value":"warning","type":"select","displayValue":"Warning - Continue Automation and report errors","structure":[]},{"id":"cache","value":"0","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":744,"y":906,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","endpoint_guid":"92afefd0-6d2d-11eb-aee2-055653605a8e","endpoint_role":"get"},{"id":"7F319E41-B5F2-4A58-A9AC-48568BF95A4F","type":"VariableBlock","disabled":false,"name":"onlyManagedSpaces","displayName":"Variable - onlyManagedSpaces","comment":"Set to 1 to only run triggers when the source app is in a managed space","childId":"3C1B5C8F-82A1-4791-98AC-5025929EB9CA","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":377,"y":3,"variableGuid":"F0CC6DA4-9009-41AE-AB10-6ACEE731A6FB","operations":[{"id":"set_value","key":"9BC74434-9E9E-4FCD-A242-FC165AA55CB7","name":"Set value of { variable }","value":"0"}]},{"id":"FFBEF4A1-7F88-4649-8EB4-01DB098050F8","type":"IfElseBlock","disabled":false,"name":"condition11","displayName":"Condition 11","comment":"App is in a managed space, or we're allowing apps from anywhere.\nAlso filter for weird situations where the app no longer exists.","childId":"FF5DB2D0-BBAD-49B3-9A68-22FA5F127C7B","inputs":[{"id":"conditions","value":{"mode":"all","conditions":[{"input1":"{count: {$.rawAPIRequest3.data}}","input2":"1","operator":"="},{"input1":"{if: {$.onlyManagedSpaces} = 1, $.getSpace2.type, 'managed'}","input2":"managed","operator":"="}]},"type":"custom","structure":[]}],"settings":[],"collapsed":[{"name":"both","isCollapsed":false},{"name":"yes","isCollapsed":false},{"name":"no","isCollapsed":false}],"x":721,"y":689,"childTrueId":"3282F9EE-58A9-4BCB-86E7-B58CEAA2F1AC","childFalseId":null},{"id":"CF046400-27FF-4142-8EC2-FFE156251FE2","type":"ShowBlock","disabled":false,"name":"output","displayName":"Output","comment":"","childId":null,"inputs":[{"id":"input","value":"| [{$.rawAPIRequest3.data[0].name}]({$.tenantHostname}/item/{$.rawAPIRequest3.data[0].id}/details) | [{$.getSpace2.name}]({$.tenantHostname}/catalog?space_filter={$.rawAPIRequest3.data[0].spaceId}) | [{$.rawAPIRequest5.data[0].status}]({$.tenantHostname}/item/{$.rawAPIRequest3.data[0].id}/history) | [LOGS]({$.tenantHostname}/api/v1/apps/{$.rawAPIRequest5.data[0].appId}/reloads/logs/{$.rawAPIRequest5.data[0].id}) | { round: {divide: { $.secondsSinceLastReload }, 60} }|","type":"string","structure":[]}],"settings":[{"id":"display_mode","value":"add","type":"select","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":914,"y":2286},{"id":"3AF17845-E480-4098-A107-3B2D4A063A6D","type":"EndpointBlock","disabled":false,"name":"getCurrentTenantInfo","displayName":"Qlik Cloud Services - Get Current Tenant Info","comment":"Get tenant hostname for use in the output blocks","childId":"00683F70-28E8-4ADD-BDBF-0C172A1D18ED","inputs":[],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"cache","value":"0","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":314,"y":246,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","endpoint_guid":"55051480-cb86-11ec-b746-892c1d04114e","endpoint_role":"get"},{"id":"00683F70-28E8-4ADD-BDBF-0C172A1D18ED","type":"VariableBlock","disabled":false,"name":"tenantHostname","displayName":"Variable - tenantHostname","comment":"","childId":"E05C8624-DB72-478E-92BD-9047EF785A3A","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":861,"y":158,"variableGuid":"2BA4CB02-FF6C-4E18-B813-15802FAB9582","operations":[{"id":"set_value","key":"98A567AC-27C8-49E4-9C54-FC30E3666BC8","name":"Set value of { variable }","value":"https://{ if: { $.getCurrentTenantInfo.hostnames[1] } empty , $.getCurrentTenantInfo.hostnames[0], $.getCurrentTenantInfo.hostnames[1] }"}]},{"id":"5B6ABE37-0069-4125-804E-CA83B9E2C17C","type":"EndpointBlock","disabled":false,"name":"rawAPIRequest5","displayName":"Qlik Cloud Services - Raw API Request 5","comment":"Find the last reload record for this app","childId":"F854AEF6-5D86-4527-9187-8FB155B11B77","inputs":[{"id":"4add8960-2078-11ec-be2c-7fc55d771fe6","value":"reloads","type":"string","structure":[]},{"id":"3b992a40-2072-11ec-9f0e-ed01586a7e1b","value":"3ba1eed0-2072-11ec-aa67-f118ee53373a","type":"select","displayValue":"GET","structure":[]},{"id":"3b8b9090-2072-11ec-8c77-5195fbb0ca65","value":null,"type":"object","mode":"keyValue","structure":[]},{"id":"993585d0-2839-11ec-b431-df4deed6c1ae","value":[{"key":"appId","value":"{ $.listApps3.item.id }"},{"key":"limit","value":"1"},{"key":"log","value":"false"}],"type":"object","mode":"keyValue","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":744,"y":1026,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","endpoint_guid":"3b75dd80-2072-11ec-9043-3b2aff6123af","endpoint_role":"create"},{"id":"F854AEF6-5D86-4527-9187-8FB155B11B77","type":"VariableBlock","disabled":false,"name":"secondsSinceLastReload","displayName":"Variable - secondsSinceLastReload","comment":"","childId":"FFBEF4A1-7F88-4649-8EB4-01DB098050F8","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":554,"y":1526,"variableGuid":"7A6050B9-9D1D-46A1-ACAB-00619A201978","operations":[{"id":"set_value","key":"43077B44-3BAD-4CAF-AA49-52BD99DD9DAF","name":"Set value of { variable }","value":"{converttimezone: 'now', , 'Etc/UTC', 'U', 'Europe/Stockholm'}"},{"id":"subtract","key":"7B5A14B7-B98F-4384-BD68-95A41B5B6B45","name":"subtract from { variable }","value":"{converttimezone: {substr: {$.rawAPIRequest5.data[0].endTime}, 0, { strpos: {$.rawAPIRequest5.data[0].endTime}, 'T' }}.{substr: {$.rawAPIRequest5.data[0].endTime}, { add: {strpos: {$.rawAPIRequest5.data[0].endTime}, 'T'}, 1 }, { subtract: {subtract: {strpos: {$.rawAPIRequest5.data[0].endTime}, 'Z' }, {strpos: {$.rawAPIRequest5.data[0].endTime}, 'T' }}, 1 }}, 'Y-m-d.H:i:s.v', 'Etc/UTC', 'U', 'Etc/UTC'}"}]},{"id":"3282F9EE-58A9-4BCB-86E7-B58CEAA2F1AC","type":"IfElseBlock","disabled":false,"name":"condition7","displayName":"Condition 7","comment":"If previous reload succeeded or there hasn't been a reload","childId":null,"inputs":[{"id":"conditions","value":{"mode":"some","conditions":[{"input1":"{$.rawAPIRequest5.data[0].status}","input2":"SUCCEEDED","operator":"="},{"input1":"{$.rawAPIRequest5.data[0].status}","input2":null,"operator":"empty"}]},"type":"custom","structure":[]}],"settings":[],"collapsed":[{"name":"both","isCollapsed":false},{"name":"yes","isCollapsed":false},{"name":"no","isCollapsed":false}],"x":945,"y":1196,"childTrueId":"69A86A6B-2B4E-411F-AD05-825B2C7CB6FC","childFalseId":"D550E15C-3B35-4C53-9FF2-53963F653DF7"},{"id":"57479A67-26C8-4998-99AB-863C701C86C5","type":"ShowBlock","disabled":false,"name":"output2","displayName":"Output 2","comment":"","childId":"87A5E759-98D9-4E78-9141-7D39ADF03B05","inputs":[{"id":"input","value":"### Reload history in space {$.getSpace2.name}\n\n| App Name | Space | History | Logs | Minutes since last reload|\n|----------|-------|---------|------|---|","type":"string","structure":[]}],"settings":[{"id":"display_mode","value":"add","type":"select","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":556,"y":473},{"id":"69A86A6B-2B4E-411F-AD05-825B2C7CB6FC","type":"IfElseBlock","disabled":false,"name":"condition13","displayName":"Condition 13","comment":"If minimum elapsed time since last reload completed or no prior reload","childId":null,"inputs":[{"id":"conditions","value":{"mode":"some","conditions":[{"input1":"{$.rawAPIRequest5.data[0].endTime}","input2":null,"operator":"empty"},{"input1":"{ round: {divide: {$.secondsSinceLastReload}, 86400}, 2 }","input2":"{$.defaultTolerance}","operator":">="}]},"type":"custom","structure":[]}],"settings":[],"collapsed":[{"name":"both","isCollapsed":false},{"name":"yes","isCollapsed":false},{"name":"no","isCollapsed":false}],"x":1153,"y":2097,"childTrueId":"5ED4BB58-A6D0-4C9B-86D1-8689FFA368E1","childFalseId":"A91E3475-7935-4417-8D71-5B6EAA9D255F"},{"id":"3C1B5C8F-82A1-4791-98AC-5025929EB9CA","type":"VariableBlock","disabled":false,"name":"defaultTolerance","displayName":"Variable - defaultTolerance","comment":"Tolerance in days. Will send notification even if app has successful reload but not updated last x days.","childId":"3AF17845-E480-4098-A107-3B2D4A063A6D","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":775,"y":-121,"variableGuid":"4E415F55-AA62-4B43-B889-AEBB44F5C80E","operations":[{"id":"set_value","key":"7DF50A3F-4FA3-49AB-9D73-BC715139150E","name":"Set value of { variable }","value":"7"}]},{"id":"0A8FA058-7CD9-4AD7-86E2-DBFD622F8538","type":"VariableBlock","disabled":false,"name":"itr","displayName":"Variable - itr","comment":"","childId":"78B0581D-C5FE-43C5-819F-38E4956A083C","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":698,"y":849,"variableGuid":"4DB40531-CE06-4100-BC96-8E10ABDF19D4","operations":[{"id":"add","key":"026CDD03-1B6E-4783-B1CB-D0C62AE4D0EB","name":"Add to { variable }","value":"1"}]},{"id":"A91E3475-7935-4417-8D71-5B6EAA9D255F","type":"VariableBlock","disabled":false,"name":"itrReloadSuccessful","displayName":"Variable - itrReloadSuccessful","comment":"","childId":"CF046400-27FF-4142-8EC2-FFE156251FE2","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":914,"y":1726,"variableGuid":"DF9328F1-6449-4821-8ABA-78DF248A7B00","operations":[{"id":"add","key":"17DA75EC-B30D-4249-9004-E29DDC4D7912","name":"Add to { variable }","value":"1"}]},{"id":"86B10DDF-703F-4FD9-842C-A25DD23D192C","type":"VariableBlock","disabled":false,"name":"itrReloadFailed","displayName":"Variable - itrReloadFailed","comment":"","childId":"53CB549C-D1F1-45FE-8B65-B33DCAA90A26","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":914,"y":1886,"variableGuid":"CBE792FC-4865-462D-A52B-ABD02A2690AB","operations":[{"id":"add","key":"AB203056-D73D-42AD-9A4B-C3E70A499086","name":"Add to { variable }","value":"1"}]},{"id":"78B0581D-C5FE-43C5-819F-38E4956A083C","type":"VariableBlock","disabled":false,"name":"errorsInLastDays","displayName":"Variable - errorsInLastDays","comment":"","childId":"649F1429-330F-4CCA-92D2-4496B5D40F30","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":868,"y":948,"variableGuid":"8F77FF4C-DAC6-418D-85D8-BC19B204EE36","operations":[{"id":"set_value","key":"5A9EB628-9803-45D0-A85D-A478A0D2BEAC","name":"Set value of { variable }","value":"no"}]},{"id":"1382F887-AAF1-4419-A43F-4C28FF5E6B03","type":"VariableBlock","disabled":false,"name":"errorsInLastDays","displayName":"Variable - errorsInLastDays","comment":"","childId":"4D4C78BB-81F3-44E5-ACCC-656BF24114B6","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":794,"y":3046,"variableGuid":"8F77FF4C-DAC6-418D-85D8-BC19B204EE36","operations":[{"id":"set_value","key":"FE9BE2FD-10C6-4F80-9524-9C46769E03B9","name":"Set value of { variable }","value":"yes"}]},{"id":"FF5DB2D0-BBAD-49B3-9A68-22FA5F127C7B","type":"IfElseBlock","disabled":false,"name":"condition3","displayName":"Condition 3","comment":"Did the automation have any failed runs in given timeline?","childId":null,"inputs":[{"id":"conditions","value":{"mode":"all","conditions":[{"input1":"{$.errorsInLastDays}","input2":"yes","operator":"="}]},"type":"custom","structure":[]}],"settings":[],"collapsed":[{"name":"yes","isCollapsed":false},{"name":"no","isCollapsed":true}],"x":758,"y":2543,"childTrueId":"7F4461FF-93FA-4B88-B61E-CFF6AED5DBDE","childFalseId":null},{"id":"7F4461FF-93FA-4B88-B61E-CFF6AED5DBDE","type":"VariableBlock","disabled":false,"name":"FailedAppsList","displayName":"Variable - FailedAppsList","comment":"","childId":null,"inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":674,"y":3246,"variableGuid":"18047299-EA5A-4459-BFBC-70F125B3EB0D","operations":[{"id":"add_item","key":"8C42A12A-B016-468D-9E18-D819FBD737BE","name":"Add item to { variable }","value":"{ $.rawAPIRequest3 }"}]},{"id":"FF2C3805-7596-48B3-9C4F-AB6BCEF9C72A","type":"IfElseBlock","disabled":false,"name":"condition14","displayName":"Condition 14","comment":"Check to see if any automations are found that match the criteria set.","childId":"BBB2BBD8-2F14-4316-B37E-9B9855C2794C","inputs":[{"id":"conditions","value":{"mode":"all","conditions":[{"input1":"{ $.FailedAppsList }","input2":null,"operator":"empty"}]},"type":"custom","structure":[]}],"settings":[],"collapsed":[{"name":"yes","isCollapsed":false},{"name":"no","isCollapsed":true}],"x":378,"y":2966,"childTrueId":"8ABC7701-9086-4E68-A11C-14FA0DC8BEEA","childFalseId":null},{"id":"8ABC7701-9086-4E68-A11C-14FA0DC8BEEA","type":"ShowBlock","disabled":false,"name":"output 2","displayName":"Output 2","comment":"If no automations were found, log that and stop the automation.","childId":"C4077C9E-DA75-4EF2-A89F-2142575B2770","inputs":[{"id":"input","value":"{object: '{\"message\":\"Halting...\",\"output\":\"No applications match that criteria! Halting...\"}'}","type":"string","structure":[]}],"settings":[{"id":"display_mode","value":"add","type":"select","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":234,"y":4576},{"id":"E645A78B-EE8E-4413-9CB8-E8D92DB49675","type":"VariableBlock","disabled":false,"name":"EmailRecipientList","displayName":"Variable - EmailRecipientList","comment":"Configuration SpaceID to check. Vill check for reload status of apps in space.","childId":"743BE233-3DCB-476B-8C49-5BC84BC8FC8B","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":564,"y":-234,"variableGuid":"D7A2338D-6C73-42A6-9731-2AF2C58A8B8D","operations":[{"id":"add_item","key":"3F00D4F8-234C-45FF-8314-D997BAE20FA3","name":"Add item to { variable }","value":"support@exsitec.se"}]},{"id":"BBB2BBD8-2F14-4316-B37E-9B9855C2794C","type":"ForEachBlock","disabled":false,"name":"loop5","displayName":"Loop 5","comment":"For each email recipient","childId":"60083B50-5A6A-4D9A-96F5-C166D7826D1D","inputs":[{"id":"input","value":"{ $.EmailRecipientList }","type":"string","structure":[]}],"settings":[{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":440,"y":4165,"loopBlockId":"6DD7D448-71C9-4677-A658-83F4DE8F02A5"},{"id":"60083B50-5A6A-4D9A-96F5-C166D7826D1D","type":"ShowBlock","disabled":false,"name":"output4","displayName":"Output 4","comment":"Output Log","childId":"219AB36E-4EF4-4F76-B7BD-291583A8CFCF","inputs":[{"id":"input","value":"{ $.LogOutputList }","type":"string","structure":[]}],"settings":[{"id":"display_mode","value":"add","type":"select","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":128,"y":9001},{"id":"6DD7D448-71C9-4677-A658-83F4DE8F02A5","type":"VariableBlock","disabled":false,"name":"EmailBody","displayName":"Variable - EmailBody","comment":"Begin building the email body, including setting the body tag, the \"Hello <User>\" opening, as well as the text before the data table.","childId":"C7C2FC65-4696-4C5B-A264-492ECE6FB99E","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":211,"y":9149,"variableGuid":"33E42217-6AAF-4887-8D76-6B04379DA683","operations":[{"id":"empty","key":"B91901B7-072E-4933-BB8F-555767D36B07","name":"Empty { variable }","value":null},{"id":"append","key":"D0BA2E82-3A87-40F8-95E5-35B2421F8588","name":"Append to { variable }","value":"<body style=\"margin:0; padding:0; font-family: 'Nunito', sans-serif; background-color: #f7f9fc; color: #384047;\">\n  <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"max-width: 600px; margin: 0 auto; background-color: #ffffff; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.05);\">\n    <tr>\n      <td style=\"padding: 30px;\">\n        <!-- Header -->\n        <h2 style=\"margin-top: 0; font-size: 22px; font-weight: 700; color: #2c3e50;\">ðŸš¨ Qlik Reload Alert</h2>\n        <!-- Message -->\n        <p style=\"font-size: 15px; line-height: 1.6; margin: 20px 0;\">\n          Hello!\n        </p>\n        <p style=\"font-size: 15px; line-height: 1.6; margin: 20px 0;\">\n          This is an automated notification from your Qlik Cloud tenant. Some applications have failed reloads or haven't been updated in time.\n        </p>\n        <!-- Failed app count summary -->\n        <div style=\"font-size: 1.4em; font-weight: 600; margin: 20px 0;\">\n          {count: { $.FailedAppsList }} application(s) with failures or overdue reloads\n        </div>"}]},{"id":"C7C2FC65-4696-4C5B-A264-492ECE6FB99E","type":"VariableBlock","disabled":false,"name":"Columns","displayName":"Variable - Columns","comment":"Define the column names. (Values are referenced in the \"ColumnContent\" block below.)","childId":"B0ABA47D-F8FD-468B-AE71-9B2EA9051817","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":434,"y":4906,"variableGuid":"B0BC1B74-183B-4CF4-B664-730B459BEFE7","operations":[{"id":"empty","key":"7A0AA9C6-BCBC-475A-B915-B3FE8FC03770","name":"Empty { variable }","value":null},{"id":"add_item","key":"413983B3-FB4E-4A03-87C1-96ABD05F8339","name":"Add item to { variable }","value":"Name"},{"id":"add_item","key":"36A773F0-3880-4C71-BC17-09268FC61880","name":"Add item to { variable }","value":"Status"},{"id":"add_item","key":"13A4120E-8FEA-4D1B-BD11-EFC6227D779F","name":"Add item to { variable }","value":"Last Reload"},{"id":"add_item","key":"82ED361B-3562-4648-8ECB-38E38E4B86C0","name":"Add item to { variable }","value":"Details"}]},{"id":"29AA099A-B7DD-420D-874F-777E8A3F9ECB","type":"ForEachBlock","disabled":false,"name":"loop8","displayName":"Loop 8","comment":"Loop over each column and add them to the table headers.","childId":"43CA46F2-B715-4A67-BBB6-7B6F65FB0CAA","inputs":[{"id":"input","value":"{ $.Columns }","type":"string","structure":[]}],"settings":[{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":351,"y":9601,"loopBlockId":"F61881DF-245B-400B-B11D-FCFB5186B895"},{"id":"43CA46F2-B715-4A67-BBB6-7B6F65FB0CAA","type":"VariableBlock","disabled":false,"name":"EmailTable","displayName":"Variable - EmailTable","comment":"Close out the table header and begin the table body.","childId":"8AA280F6-4835-4ADC-997A-23C1A0DD05EF","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":360,"y":9870,"variableGuid":"D5B115E9-B299-42DA-AEC0-7C4931B0A889","operations":[{"id":"append","key":"06C46A77-65FA-4286-B195-3CA063964F4A","name":"Append to { variable }","value":"</tr>\n          </thead>\n          <tbody>\n<tr style=\"background: #f4f7f8; border-bottom: 1px solid #ffffff;\">"}]},{"id":"8AA280F6-4835-4ADC-997A-23C1A0DD05EF","type":"ForEachBlock","disabled":false,"name":"loop11","displayName":"Loop 11","comment":"For each failed automation, sorted by name.","childId":"4034702A-05C3-4C6B-A93F-48AA3D06FA99","inputs":[{"id":"input","value":"{sort: { $.FailedAppsList }, 'name'}","type":"string","structure":[]}],"settings":[{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":608,"y":5412,"loopBlockId":"1D067786-A658-4EDB-BE33-2E019C90DE94"},{"id":"4034702A-05C3-4C6B-A93F-48AA3D06FA99","type":"VariableBlock","disabled":false,"name":"EmailTable","displayName":"Variable - EmailTable","comment":"Close out the data table HTML.","childId":"1AFDECCB-485C-47A1-88C3-810FADFB5250","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":367,"y":13152,"variableGuid":"D5B115E9-B299-42DA-AEC0-7C4931B0A889","operations":[{"id":"append","key":"982D8DCA-1564-4927-8328-45DD1DBF3B1C","name":"Append to { variable }","value":"</tbody>\n</table>\n        <!-- CTA -->\n        <a href=\"https://yourtenant\" \n           style=\"display: inline-block; margin-top: 30px; padding: 10px 20px; font-size: 14px; font-weight: 600; background-color: #0059b3; color: #ffffff; text-decoration: none; border-radius: 4px;\">\n          Go to Qlik Cloud\n        </a>\n        <!-- Footer -->\n        <p style=\"font-size: 12px; color: #888; margin-top: 40px;\">\n          This is an automated message. Please do not reply.\n        </p>\n      </td>\n    </tr>\n  </table>\n</body>"}]},{"id":"1AFDECCB-485C-47A1-88C3-810FADFB5250","type":"VariableBlock","disabled":false,"name":"EmailBody","displayName":"Variable - EmailBody","comment":"Add the data table HTML.","childId":"F4F53B6E-FF3B-4279-9BFB-5CD3C2A19AF6","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":434,"y":6406,"variableGuid":"33E42217-6AAF-4887-8D76-6B04379DA683","operations":[{"id":"append","key":"A8AA8B59-ED90-47F2-831E-59C707BF7B39","name":"Append to { variable }","value":"{ $.EmailTable }"},{"id":"append","key":"8342EEE2-DB19-4750-9A79-3083F3462161","name":"Append to { variable }","value":"<br>"}]},{"id":"F4F53B6E-FF3B-4279-9BFB-5CD3C2A19AF6","type":"VariableBlock","disabled":false,"name":"EmailBody","displayName":"Variable - EmailBody","comment":"Add the data table and email footer HTML.","childId":"3FE573FE-41D6-416D-B166-8840D8E2FAFA","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":220,"y":8679,"variableGuid":"33E42217-6AAF-4887-8D76-6B04379DA683","operations":[{"id":"append","key":"E333D268-CF3E-44B4-AAB1-E6781EB61776","name":"Append to { variable }","value":"<div style=\"text-align: center;\"><img src=\"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAMCAgICAgMCAgIDAwMDBAYEBAQEBAgGBgUGCQgKCgkICQkKDA8MCgsOCwkJDRENDg8QEBEQCgwSExIQEw8QEBD/2wBDAQMDAwQDBAgEBAgQCwkLEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBD/wAARCAAgAEkDAREAAhEBAxEB/8QAHAAAAgIDAQEAAAAAAAAAAAAABggAAQIFBwQJ/8QAOhAAAQIFAwIDAwgLAQAAAAAAAQIDBAUGBxEACCESMRMiQRRRdhUWFyM3UnKzCTIzNDZTVmFxk7HT/8QAGwEBAAMBAQEBAAAAAAAAAAAAAAECBQcEBgP/xAAqEQACAQMCBQMEAwAAAAAAAAAAAQIDBBEFMQYSEyFBUXGRFCJhsYGhwf/aAAwDAQACEQMRAD8A+gl976yOydPtRLsGuaz2YkolkqZVhbyshJWogEpbBUkE4JJUlI5PH43FboQ5sZMLiHW1oVn9TyOcm0kl6vbL8L9vsjkMvtvvBu40mf1ldb6PoWJHWxLJYhaHmUnsFJbUlQ/wt1Sh6gdteNUrqt905cp8jS0rirW117u5+nT2jHKa98NP5k364MZhQW8OzLKqgpS5guNL4X6yJlkxQtyIdQOT0pcKlnj0bdCiewPbR07qh90ZcyK1dN4q0Fde2uPqIreMstv2zl/Es/hnZLF3ypy+FNOTSWsqgJrL1BmaSx1WXIZw9iDx1IVg4VgdiCAQdeq3uI3EcrfyfW8O8Q2/EFu6lNcs49pRe6f+p+GAm6S4ta0PWto5bSk/fl0NUFRexzJttKCIlnxoZPQrqBwMLWOMd9epLszfYW3zlW4CZTGk12Snstl8KxHKVPExQRlxrKOgnrSSUAB3qSnCjlOM+kLHkME921xK0oB+3SaPn78sE4qJEHHBpKD47JKMoPUDxye2NSlkMYXVSSaAmgFHtnL0Xh3n17W8+BiIS3ATKpWws5Sy8FLaCgPxNxK/xLB9Bqz2KtKW43GqliaAVOp5ezaDefTM5kKPZpZcaFchplDN+VC4kkpKgO3LgYWT3yV+/WdNdG6TjtI5pd01ofFtGtQ7QuE1Jfnb98r98+pnvP8AtDsV8Vj8+E1px2Z0phjubuvW1tJ9bWBpGYswrNST9MBMQ5Dod8RkrZGAVA9JwtXI550SyGB++f8AebUfFbf/AFvSIYa393KQ1uIpm3lvpaamuJNsNQUrYSXEwqlDyrfCec48wRwSOSUp5MJZDYd2hlV05bSrb136phpvP4rDjrMJCtMsQQx+ySUJBcV95R4zwkYGVHjwSHGoAo1tJgzZnedXlF1Cv2WCuP0zSVRDnlQ++tanUoBPHKnIlse9SAB3GrPuiPI3Oqkk0AqtTx7V3d59MyWQqERLbcwrkTMohHKURAJJSD24cLCCO+Qv7us6b610lHaJzW7qrW+LaNGh3hbpuT/Pp88q98+he8/7Q7FfFY/PhNacdmdJZe9j+KrL/FifzIfSIZ4f0grMyiZXbmHkzwZmDtQKRCOE4CHilIQrPOMKwdIhmv2UfMqnKpqSk65lcVA3iRFPGPfm7ocei2Seo+zrP9vMvBJWCF9Sk8ISCHG1UkmgOU7gdv8AT19qeYh4iLXKp/KlF6UzZlOVw6+/QrGCpskAkAgggEH0Mp4IaONy+5m8+zTKaerS0v0jwcL9XDzWVqW4++gcAqU0lSjx6raSs9yT31OEx3Ljrh70bzp+QaQtai2sBEEJiJnM1LQ+0j16S4lKhx9xoq9xGjUcdys49SLi/P8AH9nttFa27e2u40TLZfTyayo+pUMrjpnBpbaioR5OQVFLi+tSUqUry9SspIIPVlJzKVKpa1WorMX8nOtI0jUeFdTnC3p9W2q4zJY5o++Wm8Z7+q7rDygp3QW2revK0tLNKSkLkwhadqH2yZuIdbQIdnxYZXWQtQJ4bWcJyeNaaeDo7L3UW2rev6gtdGUhIXJizIaiTGzFaHW0eAz1snrPWoZ4QrgZPGieAybsrbVvcN+3a6NkLkyEmqJEbHFDraPBZBRlZ61DPY8DJ0TwGbXcbt5auvBw1X0dGfIlfyDD0pmjSy2XSg9SWXFDnGf1Vd0k+4kGE8Bo39oavuzMqEK7rW6i5bU0sCW3UsvQ6kTIfzWuhZShfHmQopGeQcHAPHgkMvnBNf6Omv8Ash//AE1AP//Z\"><p>{ $.tenantHostname }</p></div>"},{"id":"append","key":"CEBE6C04-6838-4C2D-9657-10BFDDD83B18","name":"Append to { variable }","value":"</body>"}]},{"id":"3FE573FE-41D6-416D-B166-8840D8E2FAFA","type":"VariableBlock","disabled":false,"name":"LogOutputList","displayName":"Variable - LogOutputList","comment":"Add to output log.","childId":"20001C5D-FA12-40D2-8605-C5D5B364188E","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":340,"y":8411,"variableGuid":"EDFEDD0E-152B-4982-9CC1-004E61922EB5","operations":[{"id":"add_item","key":"67291B3A-9C24-4D80-9013-625DA8A1265C","name":"Add item to { variable }","value":"{object: '{\"message\":\"Application did not meet the required tolerance level or has failed. Sending an email notification to\",\"output\":\"{$.loop5.item}\"}'}"}]},{"id":"20001C5D-FA12-40D2-8605-C5D5B364188E","type":"EndpointBlock","disabled":false,"name":"SendMail3","displayName":"Mail - Send Mail 3","comment":"Email the user.","childId":null,"inputs":[{"id":"442845a0-cd00-11eb-9aa5-b966a68573b7","value":"{ $.loop5.item }","type":"string","structure":[]},{"id":"543f08c0-cd00-11eb-b9c6-af8e23cc2439","value":null,"type":"string","structure":[]},{"id":"5cbdb1d0-cd00-11eb-8afd-ddd4ecc002ac","value":null,"type":"string","structure":[]},{"id":"72cad1e0-cd00-11eb-aa1b-3f42c1d22e38","value":"{$.Customer} - {automationname} - Failed","type":"string","structure":[]},{"id":"79af8c50-cd24-11eb-a019-dfdc9a7f7317","value":"90ff46f0-cd24-11eb-bda1-0f1c7c213bfb","type":"select","displayValue":"html","structure":[]},{"id":"7d225d00-cd00-11eb-8493-055760e8b45a","value":"{$.EmailBody}","type":"longtext","structure":[]},{"id":"bb841f10-3341-11ec-b9a3-9d6de0bb7866","value":null,"type":"custom","structure":[]}],"settings":[{"id":"datasource","value":"9e3af860-285a-11ed-b1a0-133d757a6aec","type":"select","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":434,"y":7246,"datasourcetype_guid":"05407a80-ccfd-11eb-b098-7140f6ac27f4","endpoint_guid":"84a79bf0-ccff-11eb-a508-7d415a725ea7","endpoint_role":"create"},{"id":"0D5906A8-BF4E-4D50-B0A1-2D93FD6B90B4","type":"VariableBlock","disabled":false,"name":"EmailTable","displayName":"Variable - EmailTable","comment":"Build the data table row.","childId":"FF79600E-5191-4CA0-846E-3D71A3158F18","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":788,"y":5774,"variableGuid":"D5B115E9-B299-42DA-AEC0-7C4931B0A889","operations":[{"id":"append","key":"5317CC1C-70E4-4BF0-AA69-FC5D0C5B4A96","name":"Append to { variable }","value":"<tr style=\"background: #f4f7f8; border-bottom: 1px solid #ffffff;\">"}]},{"id":"5A94A160-2E7A-4DA1-AE4C-B258FF2751D9","type":"VariableBlock","disabled":false,"name":"ColumnContent","displayName":"Variable - ColumnContent","comment":"Column names within this block must match those within the \"Columns\" block above.","childId":"E5785CBC-2C06-4655-8CBB-CEFDDCA079D2","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":674,"y":5906,"variableGuid":"96E4CF4D-55FA-4B88-85E7-A49A061E9BE7","operations":[{"id":"empty","key":"C3AFC89B-07C1-490E-8276-D3394302E117","name":"Empty { variable }","value":null},{"id":"set_key_value","key":"D9B10F05-C325-4BBD-A212-6A49A005B011","name":"Set key/values of { variable }","value":[{"key":"Status","value":"{ $.vStatus }"},{"key":"Name","value":"{ $.loop11.item.data[0].name }"},{"key":"Details","value":"{$.tenantHostname}/item/{ $.loop11.item.data[0].id }/history"},{"key":"Last Reload","value":"{if: { count: { $.rawAPIRequest6.data } } empty , 'Never been reloaded', '$.rawAPIRequest6.data[0].endTime'}"}]}]},{"id":"E5785CBC-2C06-4655-8CBB-CEFDDCA079D2","type":"ForEachBlock","disabled":false,"name":"loop9","displayName":"Loop 9","comment":"Loop over each column and add the value to the table.","childId":"14EECA4A-32B7-4192-9D75-7B5ACEA41AD8","inputs":[{"id":"input","value":"{ $.Columns }","type":"string","structure":[]}],"settings":[{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":830,"y":6108,"loopBlockId":"6D650C70-0E1A-4C1A-B599-44E6F13783E2"},{"id":"14EECA4A-32B7-4192-9D75-7B5ACEA41AD8","type":"VariableBlock","disabled":false,"name":"EmailTable","displayName":"Variable - EmailTable","comment":"Close the table row.","childId":null,"inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":1127,"y":11644,"variableGuid":"D5B115E9-B299-42DA-AEC0-7C4931B0A889","operations":[{"id":"append","key":"EDDAECB7-498D-491E-94D2-14C4BC81729F","name":"Append to { variable }","value":"</tr>"}]},{"id":"6D650C70-0E1A-4C1A-B599-44E6F13783E2","type":"VariableBlock","disabled":false,"name":"EmailTable","displayName":"Variable - EmailTable","comment":"Add the table data with the column value.","childId":null,"inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":1321,"y":11483,"variableGuid":"D5B115E9-B299-42DA-AEC0-7C4931B0A889","operations":[{"id":"append","key":"BA74D87F-4AA2-4016-92BF-4204415D9FE9","name":"Append to { variable }","value":"<td style=\"padding: 10px;\">"},{"id":"append","key":"F6700A7B-85F3-4425-BDD8-03B2C5603520","name":"Append to { variable }","value":"{$.ColumnContent.'{$.loop9.item}'}"},{"id":"append","key":"9A510630-356E-48AE-A54E-5C7A6EE7F175","name":"Append to { variable }","value":"</td>"}]},{"id":"F61881DF-245B-400B-B11D-FCFB5186B895","type":"VariableBlock","disabled":false,"name":"EmailTable","displayName":"Variable - EmailTable","comment":"Add the Column Name to the header.","childId":null,"inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":554,"y":5006,"variableGuid":"D5B115E9-B299-42DA-AEC0-7C4931B0A889","operations":[{"id":"append","key":"14E0963F-3A4B-4823-87AB-8356312BDE64","name":"Append to { variable }","value":"<th style=\"padding: 10px;\">"},{"id":"append","key":"6E9E2B3C-8812-4923-B113-2AB3F1602EA0","name":"Append to { variable }","value":"{$.loop8.item}"},{"id":"append","key":"4CB35487-359F-4E4E-9BD2-7D9B882236D9","name":"Append to { variable }","value":"</th>"}]},{"id":"4D4C78BB-81F3-44E5-ACCC-656BF24114B6","type":"VariableBlock","disabled":false,"name":"itrReloadFailed","displayName":"Variable - itrReloadFailed","comment":"","childId":"D93E5B88-FC80-44A5-B6AA-9C7D24A10693","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":1164,"y":1886,"variableGuid":"CBE792FC-4865-462D-A52B-ABD02A2690AB","operations":[{"id":"add","key":"AB203056-D73D-42AD-9A4B-C3E70A499086","name":"Add to { variable }","value":"1"}]},{"id":"5ED4BB58-A6D0-4C9B-86D1-8689FFA368E1","type":"VariableBlock","disabled":false,"name":"errorsInLastDays","displayName":"Variable - errorsInLastDays","comment":"","childId":"86B10DDF-703F-4FD9-842C-A25DD23D192C","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":1044,"y":2406,"variableGuid":"8F77FF4C-DAC6-418D-85D8-BC19B204EE36","operations":[{"id":"set_value","key":"FE9BE2FD-10C6-4F80-9524-9C46769E03B9","name":"Set value of { variable }","value":"yes"}]},{"id":"53CB549C-D1F1-45FE-8B65-B33DCAA90A26","type":"ShowBlock","disabled":false,"name":"output3","displayName":"Output 3","comment":"","childId":null,"inputs":[{"id":"input","value":"| [{$.rawAPIRequest3.data[0].name}]({$.tenantHostname}/item/{$.rawAPIRequest3.data[0].id}/details) | [{$.getSpace2.name}]({$.tenantHostname}/catalog?space_filter={$.rawAPIRequest3.data[0].spaceId}) | [{$.rawAPIRequest5.data[0].status}]({$.tenantHostname}/item/{$.rawAPIRequest3.data[0].id}/history) | [LOGS]({$.tenantHostname}/api/v1/apps/{$.rawAPIRequest5.data[0].appId}/reloads/logs/{$.rawAPIRequest5.data[0].id}) | { round: {divide: { $.secondsSinceLastReload }, 60} }|","type":"string","structure":[]}],"settings":[{"id":"display_mode","value":"add","type":"select","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":914,"y":2126},{"id":"D93E5B88-FC80-44A5-B6AA-9C7D24A10693","type":"ShowBlock","disabled":false,"name":"output5","displayName":"Output 5","comment":"","childId":null,"inputs":[{"id":"input","value":"| [{$.rawAPIRequest3.data[0].name}]({$.tenantHostname}/item/{$.rawAPIRequest3.data[0].id}/details) | [{$.getSpace2.name}]({$.tenantHostname}/catalog?space_filter={$.rawAPIRequest3.data[0].spaceId}) | [{$.rawAPIRequest5.data[0].status}]({$.tenantHostname}/item/{$.rawAPIRequest3.data[0].id}/history) | [LOGS]({$.tenantHostname}/api/v1/apps/{$.rawAPIRequest5.data[0].appId}/reloads/logs/{$.rawAPIRequest5.data[0].id}) | { round: {divide: { $.secondsSinceLastReload }, 60} }|","type":"string","structure":[]}],"settings":[{"id":"display_mode","value":"add","type":"select","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":1164,"y":2126},{"id":"B0ABA47D-F8FD-468B-AE71-9B2EA9051817","type":"VariableBlock","disabled":false,"name":"EmailTable","displayName":"Variable - EmailTable","comment":"Add the Column Name to the header.","childId":"29AA099A-B7DD-420D-874F-777E8A3F9ECB","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":804,"y":5006,"variableGuid":"D5B115E9-B299-42DA-AEC0-7C4931B0A889","operations":[{"id":"append","key":"14E0963F-3A4B-4823-87AB-8356312BDE64","name":"Append to { variable }","value":"<!-- Data Table -->\n        <table width=\"100%\" cellpadding=\"10\" cellspacing=\"0\" border=\"0\" style=\"border-collapse: collapse; margin-top: 10px;\">\n          <thead>\n            <tr style=\"background-color: #0059b3; color: #ffffff; text-align: left;\">"}]},{"id":"9DAA5A71-FD31-4F3C-9DEE-CFDFF25287E1","type":"ErrorBlock","disabled":false,"name":"error","displayName":"Error","comment":"","childId":null,"inputs":[{"id":"message","value":"{ count: { $.FailedAppsList } } failed reloads... Causing error to enable recover email","type":"string","structure":[]},{"id":"action","value":"stop","type":"select","structure":[]}],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":434,"y":4606},{"id":"219AB36E-4EF4-4F76-B7BD-291583A8CFCF","type":"VariableBlock","disabled":false,"name":"reloadMessage","displayName":"Variable - reloadMessage","comment":"","childId":"87C77B7A-9BFD-432B-B3FB-C4EE3EDCCBD1","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":684,"y":3846,"variableGuid":"C28BBFB6-65C5-4C19-A103-223ED684887D","operations":[{"id":"set_value","key":"FCE6032E-1A3A-4519-822C-AEB699AD2D4A","name":"Set value of { variable }","value":"Applications {$.itr}:  ( {$.itrReloadSuccessful} successful,   {$.itrReloadFailed} failed)"}]},{"id":"87C77B7A-9BFD-432B-B3FB-C4EE3EDCCBD1","type":"UpdateJobBlock","disabled":false,"name":"updateRunTitle","displayName":"Update Run Title","comment":"","childId":"9DAA5A71-FD31-4F3C-9DEE-CFDFF25287E1","inputs":[{"id":"title","value":"{$.reloadMessage}","type":"string","structure":[]}],"settings":[{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":684,"y":3966},{"id":"1F6E00CD-CD79-4BE7-9318-CF80651B462A","type":"StopBlock","disabled":false,"name":"stop2","displayName":"Stop 2","comment":"","childId":null,"inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":24,"y":4180},{"id":"FF79600E-5191-4CA0-846E-3D71A3158F18","type":"IfElseBlock","disabled":false,"name":"condition","displayName":"Condition","comment":"","childId":"5A94A160-2E7A-4DA1-AE4C-B258FF2751D9","inputs":[{"id":"conditions","value":{"mode":"some","conditions":[{"input1":"{ $.rawAPIRequest6.data[0].status }","input2":"SUCCEEDED","operator":"="},{"input1":"{ count: { $.rawAPIRequest6.data } }","input2":null,"operator":"empty"}]},"type":"custom","structure":[]}],"settings":[],"collapsed":[{"name":"both","isCollapsed":false},{"name":"yes","isCollapsed":false},{"name":"no","isCollapsed":false}],"x":554,"y":5826,"childTrueId":"AB2531F2-36AD-4DE1-B84E-F1DCCE079B4F","childFalseId":"5679EBAB-9F2F-475B-B3DC-4E0F844C511D"},{"id":"5679EBAB-9F2F-475B-B3DC-4E0F844C511D","type":"VariableBlock","disabled":false,"name":"vStatus","displayName":"Variable - vStatus","comment":"","childId":null,"inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":674,"y":6026,"variableGuid":"58D9F2BA-AC38-4803-BEDE-23CED70BD9E5","operations":[{"id":"set_value","key":"89DE39A7-547F-4327-A408-D0C2ED200761","name":"Set value of { variable }","value":"{ $.rawAPIRequest6.data[0].status }"}]},{"id":"AB2531F2-36AD-4DE1-B84E-F1DCCE079B4F","type":"VariableBlock","disabled":false,"name":"vStatus","displayName":"Variable - vStatus","comment":"","childId":null,"inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":674,"y":6066,"variableGuid":"58D9F2BA-AC38-4803-BEDE-23CED70BD9E5","operations":[{"id":"set_value","key":"89DE39A7-547F-4327-A408-D0C2ED200761","name":"Set value of { variable }","value":"Not been updated the last { $.defaultTolerance }day(s)"}]},{"id":"1D067786-A658-4EDB-BE33-2E019C90DE94","type":"EndpointBlock","disabled":false,"name":"rawAPIRequest6","displayName":"Qlik Cloud Services - Raw API Request 6","comment":"Find the last reload record for this app","childId":"0D5906A8-BF4E-4D50-B0A1-2D93FD6B90B4","inputs":[{"id":"4add8960-2078-11ec-be2c-7fc55d771fe6","value":"reloads","type":"string","structure":[]},{"id":"3b992a40-2072-11ec-9f0e-ed01586a7e1b","value":"3ba1eed0-2072-11ec-aa67-f118ee53373a","type":"select","displayValue":"GET","structure":[]},{"id":"3b8b9090-2072-11ec-8c77-5195fbb0ca65","value":null,"type":"object","mode":"keyValue","structure":[]},{"id":"993585d0-2839-11ec-b431-df4deed6c1ae","value":[{"key":"appId","value":"{ $.loop11.item.data[0].resourceAttributes.id }"},{"key":"limit","value":"1"},{"key":"log","value":"false"}],"type":"object","mode":"keyValue","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":554,"y":5706,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","endpoint_guid":"3b75dd80-2072-11ec-9043-3b2aff6123af","endpoint_role":"create"},{"id":"736FBA85-C1F6-4489-8A41-0D82420452B4","type":"EndpointBlock","disabled":false,"name":"SendMail","displayName":"Mail - Send Mail","comment":"","childId":null,"inputs":[{"id":"442845a0-cd00-11eb-9aa5-b966a68573b7","value":"{ implode: { $.EmailRecipientList } }","type":"string","structure":[]},{"id":"543f08c0-cd00-11eb-b9c6-af8e23cc2439","value":null,"type":"string","structure":[]},{"id":"5cbdb1d0-cd00-11eb-8afd-ddd4ecc002ac","value":null,"type":"string","structure":[]},{"id":"72cad1e0-cd00-11eb-aa1b-3f42c1d22e38","value":"{$.Customer} - {automationname} - Recovered","type":"string","structure":[]},{"id":"79af8c50-cd24-11eb-a019-dfdc9a7f7317","value":"90ff46f0-cd24-11eb-bda1-0f1c7c213bfb","type":"select","displayValue":"html","structure":[]},{"id":"7d225d00-cd00-11eb-8493-055760e8b45a","value":"<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <title>Automation Status</title>\n  <style>\n    body {\n      font-family: \"Segoe UI\", Roboto, Arial, sans-serif;\n      background-color: #f0f4f8;\n      padding: 40px;\n      color: #2c3e50;\n    }\n    .container {\n      max-width: 600px;\n      background-color: #ffffff;\n      border-radius: 10px;\n      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);\n      margin: auto;\n      padding: 30px;\n      border-left: 6px solid #007acc; /* Blue accent */\n    }\n    .header {\n      font-size: 20px;\n      font-weight: bold;\n      color: #007acc;\n      margin-bottom: 10px;\n    }\n    .message {\n      font-size: 16px;\n      line-height: 1.6;\n    }\n    .footer {\n      margin-top: 30px;\n      font-size: 12px;\n      color: #777;\n      border-top: 1px solid #e1e1e1;\n      padding-top: 10px;\n    }\n  </style>\n</head>\n<body>\n  <div class=\"container\">\n    <div class=\"header\">{automationname} Reload Successful</div>\n    <div class=\"message\">\n      The automation <strong>{automationname}</strong> has successfully reloaded since the last failure.\n    </div>\n    <div class=\"footer\">\n      This is an automated notification from Exsitec Automation Services.\n    </div>\n  </div>\n</body>\n</html>","type":"longtext","structure":[]},{"id":"bb841f10-3341-11ec-b9a3-9d6de0bb7866","value":null,"type":"custom","structure":[]}],"settings":[{"id":"datasource","value":"9e3af860-285a-11ed-b1a0-133d757a6aec","type":"select","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":808,"y":4084,"datasourcetype_guid":"05407a80-ccfd-11eb-b098-7140f6ac27f4","endpoint_guid":"84a79bf0-ccff-11eb-a508-7d415a725ea7","endpoint_role":"create"},{"id":"D550E15C-3B35-4C53-9FF2-53963F653DF7","type":"IfElseBlock","disabled":false,"name":"condition8","displayName":"Condition 8","comment":"Or if it's reloading currently...","childId":null,"inputs":[{"id":"conditions","value":{"mode":"some","conditions":[{"input1":"{$.rawAPIRequest5.data[0].status}","input2":"RELOADING","operator":"="}]},"type":"custom","structure":[]}],"settings":[],"collapsed":[{"name":"both","isCollapsed":false},{"name":"yes","isCollapsed":false},{"name":"no","isCollapsed":false}],"x":1016,"y":2169,"childTrueId":"715FEA0F-0152-47CB-B136-0BF314CC5554","childFalseId":"1382F887-AAF1-4419-A43F-4C28FF5E6B03"},{"id":"715FEA0F-0152-47CB-B136-0BF314CC5554","type":"VariableBlock","disabled":false,"name":"itrReloading","displayName":"Variable - itrReloading","comment":"","childId":"E7EEA93A-3A07-4DEC-B347-BD2CB6B55EB5","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":1129,"y":1792,"variableGuid":"6F391AC1-BDF9-4A98-89D0-4C235E246171","operations":[{"id":"add","key":"17DA75EC-B30D-4249-9004-E29DDC4D7912","name":"Add to { variable }","value":"1"}]},{"id":"E7EEA93A-3A07-4DEC-B347-BD2CB6B55EB5","type":"ShowBlock","disabled":false,"name":"output6","displayName":"Output 6","comment":"","childId":null,"inputs":[{"id":"input","value":"| [{$.rawAPIRequest3.data[0].name}]({$.tenantHostname}/item/{$.rawAPIRequest3.data[0].id}/details) | [{$.getSpace2.name}]({$.tenantHostname}/catalog?space_filter={$.rawAPIRequest3.data[0].spaceId}) | [{$.rawAPIRequest5.data[0].status}]({$.tenantHostname}/item/{$.rawAPIRequest3.data[0].id}/history) | [LOGS]({$.tenantHostname}/api/v1/apps/{$.rawAPIRequest5.data[0].appId}/reloads/logs/{$.rawAPIRequest5.data[0].id}) | RELOADING |","type":"string","structure":[]}],"settings":[{"id":"display_mode","value":"add","type":"select","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":914,"y":2286}],"variables":[{"guid":"B0F0CA43-A941-45A3-B81C-BF5FB35A8433","name":"SpaceIDtoCheck","type":"list"},{"guid":"C7A66128-083E-4F38-8AF7-D801799B39F9","name":"AppIDtoCheck","type":"list"},{"guid":"158901F7-87FB-4DA5-ACC8-B2DAA5B7E270","name":"Customer","type":"string"},{"guid":"C28BBFB6-65C5-4C19-A103-223ED684887D","name":"reloadMessage","type":"string"},{"guid":"0EFB93DD-17BE-489F-BC78-A9B87CAE700F","name":"iter2","type":"number"},{"guid":"23D8B5BD-CE19-42E7-A754-B15533F8524C","name":"ReloadIds","type":"list"},{"guid":"4E415F55-AA62-4B43-B889-AEBB44F5C80E","name":"defaultTolerance","type":"number"},{"guid":"F0CC6DA4-9009-41AE-AB10-6ACEE731A6FB","name":"onlyManagedSpaces","type":"number"},{"guid":"2BA4CB02-FF6C-4E18-B813-15802FAB9582","name":"tenantHostname","type":"string"},{"guid":"7A6050B9-9D1D-46A1-ACAB-00619A201978","name":"secondsSinceLastReload","type":"number"},{"guid":"4DB40531-CE06-4100-BC96-8E10ABDF19D4","name":"itr","type":"number"},{"guid":"DF9328F1-6449-4821-8ABA-78DF248A7B00","name":"itrReloadSuccessful","type":"number"},{"guid":"CBE792FC-4865-462D-A52B-ABD02A2690AB","name":"itrReloadFailed","type":"number"},{"guid":"8F77FF4C-DAC6-418D-85D8-BC19B204EE36","name":"errorsInLastDays","type":"string"},{"guid":"18047299-EA5A-4459-BFBC-70F125B3EB0D","name":"FailedAppsList","type":"list"},{"guid":"D7A2338D-6C73-42A6-9731-2AF2C58A8B8D","name":"EmailRecipientList","type":"list"},{"guid":"EDFEDD0E-152B-4982-9CC1-004E61922EB5","name":"LogOutputList","type":"list"},{"guid":"33E42217-6AAF-4887-8D76-6B04379DA683","name":"EmailBody","type":"string"},{"guid":"D5B115E9-B299-42DA-AEC0-7C4931B0A889","name":"EmailTable","type":"string"},{"guid":"96E4CF4D-55FA-4B88-85E7-A49A061E9BE7","name":"ColumnContent","type":"object"},{"guid":"5B7250B6-D945-45AA-A422-059D9601BFAA","name":"created","type":"string"},{"guid":"84EFB2FA-B4EE-4586-9B00-A7590D65F968","name":"UserName","type":"string"},{"guid":"B0BC1B74-183B-4CF4-B664-730B459BEFE7","name":"Columns","type":"list"},{"guid":"58D9F2BA-AC38-4803-BEDE-23CED70BD9E5","name":"vStatus","type":"string"},{"guid":"6F391AC1-BDF9-4A98-89D0-4C235E246171","name":"itrReloading","type":"number"}]}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
