{"blocks":[{"id":"25ED9788-AF99-42DA-B44E-5E65E1586258","type":"StartBlock","disabled":false,"name":"Start","displayName":"Start","comment":"","childId":"416BD5CD-7D18-4E02-926C-1F7B753EA7C7","inputs":[{"id":"run_mode","value":"manual","type":"select","structure":{}}],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":0,"y":0},{"id":"7F383AC0-1D51-41D5-A944-0E7BF66E858E","type":"SnippetBlock","disabled":false,"name":"ImportConsumptionApp","displayName":"Qlik Cloud Services - Import Consumption App","comment":"","childId":"0F150D38-D475-4B9D-9885-6C4A41D01F0D","inputs":[{"id":"88dc9ae0-744c-11f0-bd28-67bc47cdbeec","value":null,"type":"string","structure":{}}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":{}},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":{}}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":0,"y":720,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","snippet_guid":"52c25850-73a6-11f0-9c34-07595bb5a9c1"},{"id":"0F150D38-D475-4B9D-9885-6C4A41D01F0D","type":"SnippetBlock","disabled":false,"name":"getMeasureValue","displayName":"Qlik Cloud Services - Get Measure Value","comment":"","childId":"A5079556-7948-4A2E-B4C0-E6B2FBA52693","inputs":[{"id":"7fd1a6b0-04b1-11ec-bf03-790adec74209","value":"{ $.ImportConsumptionApp.attributes.id }","type":"string","structure":{}},{"id":"bcfddcf0-04b7-11ec-8852-cfe6ca106bb5","value":"pKPjjND","type":"string","displayValue":"QDA Partial Month for monthly barchart","structure":{}},{"id":"24bfed00-76ef-11ed-99c0-7b1dab501875","value":null,"type":"select","structure":{}}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":{}},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":{}}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":0,"y":840,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","snippet_guid":"7fc83720-04b1-11ec-8bd4-7fc20db0a174"},{"id":"416BD5CD-7D18-4E02-926C-1F7B753EA7C7","type":"VariableBlock","disabled":false,"name":"threshold","displayName":"Variable - threshold","comment":"**EDIT** CHOOSE THRESEHOLD ","childId":"01681002-55F1-477C-9F04-A8E28AA18330","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":0,"y":120,"variableGuid":"63A440C4-7D11-450F-99F9-EDCA5C8D3C09","operations":[{"id":"set_value","key":"CBEEFC4E-690B-4C97-A1C7-DAD1358E42EB","name":"Set value of { variable }","value":"90"}]},{"id":"01681002-55F1-477C-9F04-A8E28AA18330","type":"EndpointBlock","disabled":false,"name":"getCurrentTenantInfo","displayName":"Qlik Cloud Services - Get Current Tenant Info","comment":"Get tenant hostname for use in the output blocks","childId":"65031E95-8CD8-4D5F-AA7D-DB7F0D2DEDFC","inputs":[],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"cache","value":"0","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":0,"y":240,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","endpoint_guid":"55051480-cb86-11ec-b746-892c1d04114e","endpoint_role":"get"},{"id":"65031E95-8CD8-4D5F-AA7D-DB7F0D2DEDFC","type":"EndpointBlock","disabled":false,"name":"getLicenseOverview2","displayName":"Qlik Cloud Services - Get License Overview 2","comment":"","childId":"12C0A816-001F-4653-871E-41F6160D960D","inputs":[],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"cache","value":"0","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":0,"y":360,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","endpoint_guid":"0e6d4530-3291-11ed-a2e9-3bc221fc190c","endpoint_role":"get"},{"id":"12C0A816-001F-4653-871E-41F6160D960D","type":"FilterListBlock","disabled":false,"name":"filterList","displayName":"Filter List","comment":"","childId":"8F0964C1-50BD-4365-9C24-F816485076F7","inputs":[{"id":"list","value":"{ $.getLicenseOverview2.parameters }","type":"string","structure":[]},{"id":"conditions","value":{"mode":"all","conditions":[{"input1":"name","input2":"dataAnalyticsCapacity","operator":"="}]},"type":"custom","structure":[]}],"settings":[{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":true}],"x":0,"y":480,"loopBlockId":null},{"id":"8F0964C1-50BD-4365-9C24-F816485076F7","type":"VariableBlock","disabled":false,"name":"Quota","displayName":"Variable - Quota","comment":"","childId":"7F383AC0-1D51-41D5-A944-0E7BF66E858E","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":0,"y":600,"variableGuid":"2970B5B8-C910-4013-8B6C-A2C796994D57","operations":[{"id":"add","key":"D7042DF3-5CFE-46A8-835D-A68177BA3387","name":"Add to { variable }","value":"{divide: { $.filterList[0].values.quantity }, 1073741824}"}]},{"id":"776334BF-722B-4D19-902C-F6E30FDF9FC6","type":"VariableBlock","disabled":false,"name":"UsedTotal","displayName":"Variable - UsedTotal","comment":"","childId":"0431B5E2-51B5-418F-AB1F-48A31F36A971","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":0,"y":1080,"variableGuid":"3BBDA0CF-57DD-4FAD-B2AC-D744BDDB21FB","operations":[{"id":"add","key":"5CDC369C-7EE7-4379-A858-9E171D23B764","name":"Add to { variable }","value":"{ $.getMeasureValue }"}]},{"id":"0431B5E2-51B5-418F-AB1F-48A31F36A971","type":"VariableBlock","disabled":false,"name":"UsedProcentage","displayName":"Variable - UsedProcentage","comment":"","childId":"147FE52C-D8DC-4019-98F3-98F2073841D5","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":0,"y":1200,"variableGuid":"1DC0D2EC-7766-44A9-AD7E-F1C205C72B27","operations":[{"id":"add","key":"5CDC369C-7EE7-4379-A858-9E171D23B764","name":"Add to { variable }","value":"{multiply: {round: {divide: { $.UsedTotal }, $.Quota}, 4}, 100}"}]},{"id":"147FE52C-D8DC-4019-98F3-98F2073841D5","type":"ShowBlock","disabled":false,"name":"output2","displayName":"Output 2","comment":"","childId":"71892F28-FFF0-4DF4-B626-2C461A57E098","inputs":[{"id":"input","value":"## Quota Information\n- **Quota:** `{$.Quota}GB`\n- **UsedTotal:** `{$.UsedTotal}GB`\n---\n### Usage Percentage\n- **Used Percentage:** `{$.UsedProcentage}%`","type":"string","structure":[]}],"settings":[{"id":"display_mode","value":"add","type":"select","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":0,"y":1320},{"id":"71892F28-FFF0-4DF4-B626-2C461A57E098","type":"IfElseBlock","disabled":false,"name":"condition","displayName":"Condition","comment":"","childId":null,"inputs":[{"id":"conditions","value":{"mode":"all","conditions":[{"input1":"{ $.UsedProcentage }","input2":"{ $.threshold }","operator":">="}]},"type":"custom","structure":[]}],"settings":[],"collapsed":[{"name":"both","isCollapsed":false},{"name":"yes","isCollapsed":false},{"name":"no","isCollapsed":false}],"x":0,"y":1440,"childTrueId":"0DE145D8-FB15-48CF-9E0E-FC9F25CF983C","childFalseId":"EA0C036C-B222-455D-84D0-DADC6BCB22E0"},{"id":"0DE145D8-FB15-48CF-9E0E-FC9F25CF983C","type":"ShowBlock","disabled":false,"name":"output","displayName":"Output","comment":"","childId":"01EA7115-BE28-43B3-8361-F8544C810990","inputs":[{"id":"input","value":"## Alert: Quota Exceeded\nWe are above the threshold percentage of **{$.threshold}%**  \nüö® **Sending email...** üö®","type":"string","structure":[]}],"settings":[{"id":"display_mode","value":"add","type":"select","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":120,"y":1520},{"id":"01EA7115-BE28-43B3-8361-F8544C810990","type":"EndpointBlock","disabled":false,"name":"SendMail","displayName":"Mail - Send Mail","comment":"","childId":null,"inputs":[{"id":"442845a0-cd00-11eb-9aa5-b966a68573b7","value":"Qlikard@exsitec.se","type":"string","structure":[]},{"id":"543f08c0-cd00-11eb-b9c6-af8e23cc2439","value":null,"type":"string","structure":[]},{"id":"5cbdb1d0-cd00-11eb-8afd-ddd4ecc002ac","value":null,"type":"string","structure":[]},{"id":"72cad1e0-cd00-11eb-aa1b-3f42c1d22e38","value":"Quota Alert: Usage Exceeded","type":"string","structure":[]},{"id":"79af8c50-cd24-11eb-a019-dfdc9a7f7317","value":"95798c80-cd24-11eb-ab8e-25df5b4926cf","type":"select","displayValue":"markdown","structure":[]},{"id":"7d225d00-cd00-11eb-8493-055760e8b45a","value":"## ‚ö†Ô∏è Quota Alert: Usage Exceeded\nHello,\n\nWe have exceeded the quota threshold. Here are the current details:\n\n## Quota Information\n- **Quota:** `{$.Quota}GB`\n- **UsedTotal:** `{$.UsedTotal}GB`\n---\n### Usage Percentage\n- **Used Percentage:** `{$.UsedProcentage}%`\nPlease take the necessary actions to address this.\n[üîç View Usage Dashboard](https://{if: { $.getCurrentTenantInfo.hostnames[1] } empty , $.getCurrentTenantInfo.hostnames[0], $.getCurrentTenantInfo.hostnames[1]}/admin/home)\n---\nThis is an automated notification. Please do not reply to this email.","type":"longtext","structure":[]},{"id":"bb841f10-3341-11ec-b9a3-9d6de0bb7866","value":null,"type":"custom","structure":[]}],"settings":[{"id":"datasource","value":null,"type":"select","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":120,"y":1640,"datasourcetype_guid":"05407a80-ccfd-11eb-b098-7140f6ac27f4","endpoint_guid":"84a79bf0-ccff-11eb-a508-7d415a725ea7","endpoint_role":"create"},{"id":"EA0C036C-B222-455D-84D0-DADC6BCB22E0","type":"ShowBlock","disabled":false,"name":"output3","displayName":"Output 3","comment":"","childId":null,"inputs":[{"id":"input","value":"## Status: Within Limits\n‚úÖ We are below the threshold percentage ({ $.threshold }%). No action is needed.","type":"string","structure":[]}],"settings":[{"id":"display_mode","value":"add","type":"select","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":120,"y":1800},{"id":"A5079556-7948-4A2E-B4C0-E6B2FBA52693","type":"EndpointBlock","disabled":false,"name":"deleteApp","displayName":"Qlik Cloud Services - Delete App","comment":"","childId":"776334BF-722B-4D19-902C-F6E30FDF9FC6","inputs":[{"id":"fcd14a20-67b2-11eb-9f5e-9113990ec3b6","value":"{ $.ImportConsumptionApp.attributes.id }","type":"string","structure":{}}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":{}},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":{}}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":0,"y":960,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","endpoint_guid":"fcc108b0-67b2-11eb-806a-3957ec36f31b","endpoint_role":"delete"}],"variables":[{"guid":"1DC0D2EC-7766-44A9-AD7E-F1C205C72B27","name":"UsedProcentage","type":"number"},{"guid":"3BBDA0CF-57DD-4FAD-B2AC-D744BDDB21FB","name":"UsedTotal","type":"number"},{"guid":"2970B5B8-C910-4013-8B6C-A2C796994D57","name":"Quota","type":"number"},{"guid":"63A440C4-7D11-450F-99F9-EDCA5C8D3C09","name":"threshold","type":"number"}]}